<script>

    function ifAccessDo(callback) {
        const access_token = localStorage.getItem('token');
        if (typeof access_token === 'undefined') { 
            window.location.href = "/"; 
        }
        else {
            const options = { headers: { "Authorization": "Bearer " + access_token } }
            fetch("/users/me", options )
            .then(response => response.json())
            .then( response =>  {

                if (!response.hasOwnProperty('username')) {
                   window.location.href = "/";
                }
                else {
                    if (typeof callback == "function")
                        callback();
                }
            });
        }
    }
    
    function ifAccessDoWithUser(callback) {
        const access_token = localStorage.getItem('token');
        if (typeof access_token === 'undefined') { 
            window.location.href = "/"; 
        }
        else {
            const options = { headers: { "Authorization": "Bearer " + access_token } }
            fetch("/users/me", options )
            .then(response => response.json())
            .then( response =>  {

                if (!response.hasOwnProperty('username')) {
                   window.location.href = "/";
                }
                else {
                    if (typeof callback == "function")
                        callback(response);
                }
            });
        }
    }
</script>